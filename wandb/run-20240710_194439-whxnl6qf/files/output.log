
  0%|                                                                                                                                                                               | 0/300 [00:00<?, ?it/s]/data/ruanjh/miniconda3/envs/mamba/lib/python3.11/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  0%|▌                                                                                                                                                                      | 1/300 [00:05<25:00,  5.02s/it]

  1%|█                                                                                                                                                                      | 2/300 [00:07<17:10,  3.46s/it]
{'eval_loss': 0.20138156414031982, 'eval_similarity': 0.8878484964370728, 'eval_runtime': 0.0601, 'eval_samples_per_second': 16.651, 'eval_steps_per_second': 16.651, 'epoch': 2.0}

  1%|█▋                                                                                                                                                                     | 3/300 [00:09<14:38,  2.96s/it]

  1%|██▏                                                                                                                                                                    | 4/300 [00:12<13:07,  2.66s/it]

  2%|██▊                                                                                                                                                                    | 5/300 [00:14<12:36,  2.57s/it]


  2%|███▉                                                                                                                                                                   | 7/300 [00:19<12:09,  2.49s/it]

  3%|████▍                                                                                                                                                                  | 8/300 [00:21<11:41,  2.40s/it]
{'eval_loss': 1.288394808769226, 'eval_similarity': 0.8172348141670227, 'eval_runtime': 0.0605, 'eval_samples_per_second': 16.531, 'eval_steps_per_second': 16.531, 'epoch': 8.0}

  3%|█████                                                                                                                                                                  | 9/300 [00:23<11:33,  2.38s/it]

  3%|█████▌                                                                                                                                                                | 10/300 [00:26<11:28,  2.37s/it]


  4%|██████▋                                                                                                                                                               | 12/300 [00:30<11:29,  2.39s/it]

  4%|███████▏                                                                                                                                                              | 13/300 [00:33<11:31,  2.41s/it]
{'eval_loss': 1.3292076587677002, 'eval_similarity': 0.7678577899932861, 'eval_runtime': 0.0602, 'eval_samples_per_second': 16.611, 'eval_steps_per_second': 16.611, 'epoch': 13.0}

  5%|███████▋                                                                                                                                                              | 14/300 [00:35<11:31,  2.42s/it]

  5%|████████▎                                                                                                                                                             | 15/300 [00:38<11:28,  2.41s/it]

  5%|████████▊                                                                                                                                                             | 16/300 [00:40<11:23,  2.40s/it]


  6%|█████████▉                                                                                                                                                            | 18/300 [00:45<11:01,  2.35s/it]

  6%|██████████▌                                                                                                                                                           | 19/300 [00:47<11:01,  2.35s/it]
{'eval_loss': 0.98247891664505, 'eval_similarity': 0.9207756519317627, 'eval_runtime': 0.0609, 'eval_samples_per_second': 16.433, 'eval_steps_per_second': 16.433, 'epoch': 19.0}

  7%|███████████                                                                                                                                                           | 20/300 [00:50<11:05,  2.38s/it]

  7%|███████████▌                                                                                                                                                          | 21/300 [00:52<11:07,  2.39s/it]


  8%|████████████▋                                                                                                                                                         | 23/300 [00:57<10:59,  2.38s/it]

  8%|█████████████▎                                                                                                                                                        | 24/300 [00:59<10:55,  2.37s/it]
{'eval_loss': 0.2752143144607544, 'eval_similarity': 0.938140869140625, 'eval_runtime': 0.0603, 'eval_samples_per_second': 16.588, 'eval_steps_per_second': 16.588, 'epoch': 24.0}

  8%|█████████████▊                                                                                                                                                        | 25/300 [01:01<10:37,  2.32s/it]

  9%|██████████████▍                                                                                                                                                       | 26/300 [01:04<10:42,  2.35s/it]

  9%|██████████████▉                                                                                                                                                       | 27/300 [01:06<10:48,  2.38s/it]


 10%|████████████████                                                                                                                                                      | 29/300 [01:11<10:53,  2.41s/it]

 10%|████████████████▌                                                                                                                                                     | 30/300 [01:13<10:29,  2.33s/it]
{'eval_loss': 1.0545756816864014, 'eval_similarity': 0.9302829504013062, 'eval_runtime': 0.0607, 'eval_samples_per_second': 16.462, 'eval_steps_per_second': 16.462, 'epoch': 30.0}

 10%|█████████████████▏                                                                                                                                                    | 31/300 [01:15<10:29,  2.34s/it]

 11%|█████████████████▋                                                                                                                                                    | 32/300 [01:18<10:29,  2.35s/it]


 11%|██████████████████▊                                                                                                                                                   | 34/300 [01:23<10:30,  2.37s/it]

 12%|███████████████████▎                                                                                                                                                  | 35/300 [01:25<10:40,  2.42s/it]
{'eval_loss': 0.8704624772071838, 'eval_similarity': 0.974442720413208, 'eval_runtime': 0.0605, 'eval_samples_per_second': 16.529, 'eval_steps_per_second': 16.529, 'epoch': 35.0}

 12%|███████████████████▉                                                                                                                                                  | 36/300 [01:28<10:38,  2.42s/it]


 13%|█████████████████████                                                                                                                                                 | 38/300 [01:32<10:14,  2.35s/it]

 13%|█████████████████████▌                                                                                                                                                | 39/300 [01:34<10:11,  2.34s/it]

 13%|██████████████████████▏                                                                                                                                               | 40/300 [01:37<10:11,  2.35s/it]
{'eval_loss': 0.4327976405620575, 'eval_similarity': 0.9715123176574707, 'eval_runtime': 0.0604, 'eval_samples_per_second': 16.569, 'eval_steps_per_second': 16.569, 'epoch': 40.0}

 14%|██████████████████████▋                                                                                                                                               | 41/300 [01:39<10:13,  2.37s/it]

 14%|███████████████████████▏                                                                                                                                              | 42/300 [01:42<10:15,  2.39s/it]


 15%|████████████████████████▎                                                                                                                                             | 44/300 [01:46<09:55,  2.33s/it]

 15%|████████████████████████▉                                                                                                                                             | 45/300 [01:49<09:54,  2.33s/it]

 15%|█████████████████████████▍                                                                                                                                            | 46/300 [01:51<09:55,  2.34s/it]
{'eval_loss': 0.8384509682655334, 'eval_similarity': 0.9831746816635132, 'eval_runtime': 0.0601, 'eval_samples_per_second': 16.625, 'eval_steps_per_second': 16.625, 'epoch': 46.0}

 16%|██████████████████████████                                                                                                                                            | 47/300 [01:53<09:56,  2.36s/it]

 16%|██████████████████████████▌                                                                                                                                           | 48/300 [01:56<09:58,  2.37s/it]

 16%|███████████████████████████                                                                                                                                           | 49/300 [01:58<09:56,  2.38s/it]


 17%|████████████████████████████▏                                                                                                                                         | 51/300 [02:03<09:35,  2.31s/it]

 17%|████████████████████████████▊                                                                                                                                         | 52/300 [02:05<09:34,  2.32s/it]
 17%|████████████████████████████▊                                                                                                                                         | 52/300 [02:05<09:34,  2.32s/it]Traceback (most recent call last):
  File "/data/ruanjh/best_training_method/sft/pre/train.py", line 152, in <module>
    trainer.train()
  File "/data/ruanjh/miniconda3/envs/mamba/lib/python3.11/site-packages/transformers/trainer.py", line 1885, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/ruanjh/miniconda3/envs/mamba/lib/python3.11/site-packages/transformers/trainer.py", line 2221, in _inner_training_loop
    and (torch.isnan(tr_loss_step) or torch.isinf(tr_loss_step))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt